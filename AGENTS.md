# Gemini Project Context: DocFX Documentation

## Project Overview
This project is a documentation site generator for the Unity game *Lobotomy Corporation* (inferred from code symbols like `BinahBoss`, `CreatureGenerate`). It utilizes **DocFX** to generate API references directly from the game's assemblies (DLLs) and includes a custom toolchain to convert this metadata into **Wiki.js** compatible Markdown.

## Directory Structure
- **`assemblies/`**: Contains the managed assemblies (DLLs) of the game, including `Assembly-CSharp.dll` (main game logic) and Unity engine libraries. These are the source of truth for the API documentation.
- **`api/`**: Contains YAML metadata files generated by DocFX from the assemblies in `assemblies/`. These files represent the structure of the classes, methods, and properties.
- **`scripts/`**: Contains utility scripts, primarily `docfx_yml_to_wikijs.py` for converting DocFX YAML to Wiki.js Markdown.
- **`_site/`**: The output directory containing the generated static HTML website (standard DocFX output).
- **`wikijs_out/`**: (Generated) The output directory containing the Markdown files ready for Wiki.js.
- **`docfx.json`**: The main configuration file for DocFX, defining input sources (`assemblies/`), output destinations (`api/`, `_site`), and templates.
- **`main.py`**: The orchestration script that runs `docfx metadata` followed by the Wiki.js conversion script.
- **`pyproject.toml`**: Python project configuration using `uv` for dependency management, including tools like `mypy` and `ruff`.

## Building and Running

### Prerequisites
- **DocFX**: Required to generate metadata (`dotnet docfx`).
- **Python 3.12+**: Required for the Python tooling.
- **uv**: Recommended for managing Python dependencies.
- **ripgrep**: Available via the `rg` command for fast searching.

### Key Commands

#### Full Build (Metadata + Conversion)
To regenerate the DocFX metadata and convert it to Wiki.js format in one go:
```bash
uv run python main.py
```

#### Development Cycle (Recommended)
To run the full development pipeline (Linting -> Type Checking -> Build):
```bash
uv run python dev.py
```

#### Documentation Build (Standard DocFX)
To only build the standard DocFX static site:
```bash
# Generate metadata and build the site
docfx docfx.json
# Or serve locally
docfx docfx.json --serve
```

#### Wiki.js Conversion (Manual)
To run the conversion script manually (assuming metadata in `api/` exists):
```bash
uv run python scripts/docfx_yml_to_wikijs.py api wikijs_out --include-namespace-pages --include-member-details --home-page
```

#### Python Environment
To set up and run the Python environment:
```bash
# Install dependencies
uv sync

# Run the development script (wraps ruff, mypy, and main.py)
uv run python dev.py
```

## Conventions
- **API Generation**: The project relies on `assemblies/Assembly-CSharp.dll` as the primary source for API documentation. Avoid manually editing generated files in `api/` unless you are sure they won't be overwritten.
- **Conversion Logic**: Modifications to the Wiki.js output format should be made in `scripts/docfx_yml_to_wikijs.py`.
- **Output Naming**: Generated Markdown files use hyphens instead of periods for namespaces and types (e.g., `My-Namespace-Class.md`) to ensure compatibility with Wiki.js, which restricts special characters in page paths.
- **Markdown**: General documentation is written in standard Markdown (e.g., `index.md`).
- **Python Style**: Adhere to `ruff` and `mypy` standards for any Python scripts added to the project.
